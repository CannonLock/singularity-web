(self.webpackChunksingularity_web=self.webpackChunksingularity_web||[]).push([[549],{3599:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return r},metadata:function(){return s},toc:function(){return l},default:function(){return d}});var i=t(2122),a=t(9756),o=(t(7294),t(3905)),r={id:"admin_quickstart",title:"Admin Quick Start",slug:"/"},s={unversionedId:"admin_quickstart",id:"admin_quickstart",isDocsHomePage:!1,title:"Admin Quick Start",description:"This quick start gives an overview of installation of Singularity from",source:"@site/docs-admin/admin_quickstart.md",sourceDirName:".",slug:"/",permalink:"/docs-admin/",editUrl:"https://github.com/hpcng/singularity-web/edit/main/docs-admin/admin_quickstart.md",version:"current",frontMatter:{id:"admin_quickstart",title:"Admin Quick Start",slug:"/"},sidebar:"someSidebar",next:{title:"Installing Singularity",permalink:"/docs-admin/installation"}},l=[{value:"Architecture of Singularity",id:"architecture-of-singularity",children:[]},{value:"Singularity Security",id:"singularity-security",children:[]},{value:"Installation from Source",id:"installation-from-source",children:[{value:"Install Dependencies",id:"install-dependencies",children:[]},{value:"Install Go",id:"install-go",children:[]},{value:"Download Singularity from a GitHub release",id:"download-singularity-from-a-github-release",children:[]},{value:"Compile &amp; Install Singularity",id:"compile--install-singularity",children:[]}]},{value:"Configuration",id:"configuration",children:[]},{value:"Test Singularity",id:"test-singularity",children:[]}],u={toc:l};function d(e){var n=e.components,t=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,i.Z)({},u,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This quick start gives an overview of installation of Singularity from\nsource, a description of the architecture of Singularity, and\npointers to configuration files. More information, including alternate\ninstallation options and detailed configuration options can be found\nlater in this guide."),(0,o.kt)("h2",{id:"architecture-of-singularity"},"Architecture of Singularity"),(0,o.kt)("p",null,"Singularity is designed to allow containers to be executed as if they\nwere native programs or scripts on a host system. No daemon is\nrequired to build or run containers, and the security model is compatible\nwith shared systems."),(0,o.kt)("p",null,"As a result, integration with clusters and schedulers such as Univa\nGrid Engine, Torque, SLURM, SGE, and many others is as simple as\nrunning any other command. All standard input, output, errors, pipes,\nIPC, and other communication pathways used by locally running programs\nare synchronized with the applications running locally within the\ncontainer."),(0,o.kt)("p",null,"Singularity favors an 'integration over isolation' approach to\ncontainers. By default only the mount namespace is isolated for\ncontainers, so that they have their own filesystem view. Access to\nhardware such as GPUs, high speed networks, and shared filesystems is\neasy and does not require special configuration. User home\ndirectories, ",(0,o.kt)("inlineCode",{parentName:"p"},"/tmp")," space, and installation specific mounts make it\nsimple for users to benefit from the reproducibility of containerized\napplications without major changs to their existing workflows. Where\nmore complete isolation is important, Singularity can use additional\nLinux namespaces and other security and resource limits to accomplish\nthis."),(0,o.kt)("h2",{id:"singularity-security"},"Singularity Security"),(0,o.kt)("p",null,"Singularity uses a number of strategies to provide safety and\nease-of-use on both single-user and shared systems. Notable security\nfeatures include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The user inside a container is the same as the user who ran the\ncontainer. This means access to files and devices from the\ncontainer is easily controlled with standard POSIX permissions."),(0,o.kt)("li",{parentName:"ul"},"Container filesystems are mounted ",(0,o.kt)("inlineCode",{parentName:"li"},"nosuid")," and container\napplications run with the ",(0,o.kt)("inlineCode",{parentName:"li"},"PR_NO_NEW_PRIVS")," flag set. This means\nthat applications in a container cannot gain additional\nprivileges. A regular user cannot ",(0,o.kt)("inlineCode",{parentName:"li"},"sudo")," or otherwise gain root\nprivilege on the host via a container."),(0,o.kt)("li",{parentName:"ul"},"The Singularity Image Format (SIF) supports encryption of containers,\nas well as cryptographic signing and verification of their content."),(0,o.kt)("li",{parentName:"ul"},"SIF containers are immutable and their payload is run directly,\nwithout extraction to disk. This means that the container can\nalways be verified, even at runtime, and encrypted content is not\nexposed on disk."),(0,o.kt)("li",{parentName:"ul"},"Restrictions can be configured to limit the ownership, location, and\ncryptographic signatures of containers that are permitted to be run.")),(0,o.kt)("p",null,"To support the SIF image format, automated networking setup etc., and\nolder Linux distributions without user namespace support, Singularity\nruns small amounts of privileged container setup code via a\n",(0,o.kt)("inlineCode",{parentName:"p"},"starter-setuid")," binary. This is a 'setuid root' binary, so that\nSingularity can perform filesystem loop mounts and other operations\nthat need privilege. The setuid flow is the default mode of operation,\nbut ",(0,o.kt)("a",{parentName:"p",href:"install-nonsetuid"},"can be disabled")," on build, or in the\n",(0,o.kt)("inlineCode",{parentName:"p"},"singularity.conf")," configuration file if required."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Running Singularity in non-setuid mode requires unprivileged user\nnamespace support in the operating system kernel and does not\nsupport all features, most notably direct mounts of SIF\nimages. This impacts integrity/security guarantees of containers at\nruntime."),(0,o.kt)("p",{parentName:"div"},"See the ",(0,o.kt)("a",{parentName:"p",href:"install-nonsetuid"},"non-setuid installation section")," for further\ndetail on how to install singularity to run in non-setuid mode."))),(0,o.kt)("h2",{id:"installation-from-source"},"Installation from Source"),(0,o.kt)("p",null,"Singularity Community Edition can be installed from source directly,\nor by building an RPM package from the source. Various Linux\ndistributions also package Singularity, but their packages may not be\nup-to-date with the upstream version on GitHub."),(0,o.kt)("p",null,"To install Singularity directly from source, follow the procedure\nbelow. Other methods are discussed in the ",(0,o.kt)("a",{parentName:"p",href:"installation"},"Installation")," section."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"This quick-start that you will install as ",(0,o.kt)("inlineCode",{parentName:"p"},"root")," using\n",(0,o.kt)("inlineCode",{parentName:"p"},"sudo"),", so that Singularity uses the default ",(0,o.kt)("inlineCode",{parentName:"p"},"setuid"),"\nworkflow, and all features are available. See the ",(0,o.kt)("a",{parentName:"p",href:"install-nonsetuid"},"non-setuid\ninstallation")," section of this guide for detail\nof how to install as a non-root user, and how this affects the\nfunctionality of Singularity."))),(0,o.kt)("h3",{id:"install-dependencies"},"Install Dependencies"),(0,o.kt)("p",null,"On Red Hat Enterprise Linux or CentOS install the following dependencies:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo yum update -y && \\\n     sudo yum groupinstall -y 'Development Tools' && \\\n     sudo yum install -y \\\n     openssl-devel \\\n     libuuid-devel \\\n     libseccomp-devel \\\n     wget \\\n     squashfs-tools \\\n     cryptsetup\n")),(0,o.kt)("p",null,"On Ubuntu or Debian install the following dependencies:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo apt-get update && sudo apt-get install -y \\\n    build-essential \\\n    uuid-dev \\\n    libgpgme-dev \\\n    squashfs-tools \\\n    libseccomp-dev \\\n    wget \\\n    pkg-config \\\n    git \\\n    cryptsetup-bin\n")),(0,o.kt)("h3",{id:"install-go"},"Install Go"),(0,o.kt)("p",null,"Singularity v3 is written primarily in Go, and you will need Go 1.13\nor above installed to compile it from source. Versions of Go packaged\nby your distribution may not be new enough to build Singularity."),(0,o.kt)("p",null,"The method below is one of several ways to ",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/doc/install"},"install and configure Go"),"."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"If you have previously installed Go from a download, rather than an\noperating system package, you should remove your ",(0,o.kt)("inlineCode",{parentName:"p"},"go")," directory,\ne.g. ",(0,o.kt)("inlineCode",{parentName:"p"},"rm -r /usr/local/go")," before installing a newer\nversion. Extracting a new version of Go over an existing\ninstallation can lead to errors when building Go programs, as it\nmay leave old files, which have been removed or replaced in newer\nversions."))),(0,o.kt)("p",null,"Visit the ",(0,o.kt)("a",{parentName:"p",href:"https://golang.org/dl/"},"Go download page")," and pick a package\narchive to download. Copy the link address and download with wget.  Then extract\nthe archive to ",(0,o.kt)("inlineCode",{parentName:"p"},"/usr/local")," (or use other instructions on go installation\npage)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ export VERSION=1.14.12 OS=linux ARCH=amd64 && \\\n    wget https://dl.google.com/go/go$VERSION.$OS-$ARCH.tar.gz && \\\n    sudo tar -C /usr/local -xzvf go$VERSION.$OS-$ARCH.tar.gz && \\\n    rm go$VERSION.$OS-$ARCH.tar.gz\n")),(0,o.kt)("p",null,"Then, set up your environment for Go."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"    $ echo 'export GOPATH=${HOME}/go' >> ~/.bashrc && \\\n        echo 'export PATH=/usr/local/go/bin:${PATH}:${GOPATH}/bin' >> ~/.bashrc && \\\n        source ~/.bashrc\n")),(0,o.kt)("h3",{id:"download-singularity-from-a-github-release"},"Download Singularity from a GitHub release"),(0,o.kt)("p",null,"You can download Singularity from one of the releases. To see a full list, visit\n",(0,o.kt)("a",{parentName:"p",href:"https://github.com/hpcng/singularity/releases"},"the GitHub release page"),".\nAfter deciding on a release to install, you can run the following commands to\nproceed with the installation."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ export VERSION={InstallationVersion} && # adjust this as necessary \\\n    wget https://github.com/hpcng/singularity/releases/download/v${VERSION}/singularity-${VERSION}.tar.gz && \\\n    tar -xzf singularity-${VERSION}.tar.gz && \\\n    cd singularity\n")),(0,o.kt)("h3",{id:"compile--install-singularity"},"Compile & Install Singularity"),(0,o.kt)("p",null,"Singularity uses a custom build system called ",(0,o.kt)("inlineCode",{parentName:"p"},"makeit"),".  ",(0,o.kt)("inlineCode",{parentName:"p"},"mconfig")," is called\nto generate a ",(0,o.kt)("inlineCode",{parentName:"p"},"Makefile")," and then ",(0,o.kt)("inlineCode",{parentName:"p"},"make")," is used to compile and install."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ ./mconfig && \\\n    make -C ./builddir && \\\n    sudo make -C ./builddir install\n")),(0,o.kt)("p",null,"By default Singularity will be installed in the ",(0,o.kt)("inlineCode",{parentName:"p"},"/usr/local")," directory\nhierarchy. You can specify a custom directory with the ",(0,o.kt)("inlineCode",{parentName:"p"},"--prefix")," option, to\n",(0,o.kt)("inlineCode",{parentName:"p"},"mconfig"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ ./mconfig --prefix=/opt/singularity\n")),(0,o.kt)("p",null,"This option can be useful if you want to install multiple versions of\nSingularity, install a personal version of Singularity on a shared system, or if\nyou want to remove Singularity easily after installing it."),(0,o.kt)("p",null,"For a full list of ",(0,o.kt)("inlineCode",{parentName:"p"},"mconfig")," options, run ",(0,o.kt)("inlineCode",{parentName:"p"},"mconfig --help"),".  Here\nare some of the most common options that you may need to use when\nbuilding Singularity from source."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"--sysconfdir"),": Install read-only config files in sysconfdir.\nThis option is important if you need the ",(0,o.kt)("inlineCode",{parentName:"p"},"singularity.conf")," file\nor other configuration files in a custom location.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"--localstatedir"),": Set the state directory where containers are\nmounted. This is a particularly important option for administrators\ninstalling Singularity on a shared file system.  The\n",(0,o.kt)("inlineCode",{parentName:"p"},"--localstatedir")," should be set to a directory that is present on\neach individual node.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"-b"),": Build Singularity in a given directory. By default this is\n",(0,o.kt)("inlineCode",{parentName:"p"},"./builddir"),"."))),(0,o.kt)("h2",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"Singularity is configured using files under ",(0,o.kt)("inlineCode",{parentName:"p"},"etc/singularity")," in\nyour ",(0,o.kt)("inlineCode",{parentName:"p"},"--prefix"),", or ",(0,o.kt)("inlineCode",{parentName:"p"},"--syconfdir")," if you used that option with\n",(0,o.kt)("inlineCode",{parentName:"p"},"mconfig"),". In a default installation from source without a\n",(0,o.kt)("inlineCode",{parentName:"p"},"--prefix")," set you will find them under\n",(0,o.kt)("inlineCode",{parentName:"p"},"/usr/local/etc/singularity"),"."),(0,o.kt)("p",null,"You can edit these files directly, or using the ",(0,o.kt)("inlineCode",{parentName:"p"},"singularity config\nglobal")," command as the root user to manage them."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"singularity.conf")," contains the majority of options controlling the\nruntime behaviour of Singularity. Additional files control security,\nnetwork, and resource configuration. Head over to the\n",(0,o.kt)("a",{parentName:"p",href:"singularity_configfiles"},"Configuration files")," section where the\nfiles and configuration options are discussed."),(0,o.kt)("h2",{id:"test-singularity"},"Test Singularity"),(0,o.kt)("p",null,"You can run a quick test of Singularity using a container in the\nSylabs Container Library:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ singularity exec library://alpine cat /etc/alpine-release\n3.9.2\n")),(0,o.kt)("p",null,"See the ",(0,o.kt)("a",{parentName:"p",href:"/user-docs"},"user guide")," for more information about how to use Singularity."))}d.isMDXComponent=!0}}]);
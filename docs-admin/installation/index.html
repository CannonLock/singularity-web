<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="Singularity Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="Singularity Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Singularity" href="/opensearch.xml"><title data-react-helmet="true">Installing Singularity | Singularity</title><meta data-react-helmet="true" property="og:url" content="https://singularity.hpcng.org/docs-admin/installation"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-docs-admin-current"><meta data-react-helmet="true" property="og:title" content="Installing Singularity | Singularity"><meta data-react-helmet="true" name="description" content="This section will guide you through the process of installing"><meta data-react-helmet="true" property="og:description" content="This section will guide you through the process of installing"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://singularity.hpcng.org/docs-admin/installation"><link data-react-helmet="true" rel="alternate" href="https://singularity.hpcng.org/docs-admin/installation" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://singularity.hpcng.org/docs-admin/installation" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.df3ffb68.css">
<link rel="preload" href="/assets/js/runtime~main.8b668661.js" as="script">
<link rel="preload" href="/assets/js/main.d90a00b9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Singularity</strong></a><a class="navbar__item navbar__link" href="/docs-user/">User Documentation</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-admin/">Administrator Documentation</a><a class="navbar__item navbar__link" href="/news">News</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hpcng/singularity" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Singularity</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-user/">User Documentation</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs-admin/">Administrator Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/news">News</a></li><li class="menu__list-item"><a href="https://github.com/hpcng/singularity" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs-admin/">Admin Quick Start</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs-admin/installation">Installing Singularity</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-admin/configfiles">Configuration Files</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-admin/user_namespace">User Namespaces &amp; Fakeroot</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-admin/security">Container Security</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-admin/appendix">Appendix</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Installing Singularity</h1></header><div class="markdown"><p>This section will guide you through the process of installing
Singularity 3.7.0 via several different methods. (For
instructions on installing earlier versions of Singularity please see
<a href="https://www.sylabs.io/docs/" target="_blank" rel="noopener noreferrer">earlier versions of the docs</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="installation-on-linux"></a>Installation on Linux<a class="hash-link" href="#installation-on-linux" title="Direct link to heading">#</a></h2><p>Singularity can be installed on any modern Linux distribution, on
bare-metal or inside a Virtual Machine. Nested installations inside
containers are not recommended, and require the outer container to be
run with full privilege.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="system-requirements"></a>System Requirements<a class="hash-link" href="#system-requirements" title="Direct link to heading">#</a></h3><p>Singularity requires ~140MiB disk space once compiled and installed.</p><p>There are no specific CPU or memory requirements at runtime, though
2GB of RAM is recommended when building from source.</p><p>Full functionality of Singularity requires that the kernel supports:</p><ul><li><strong>OverlayFS mounts</strong> - (minimum kernel &gt;=3.18) Required for full
flexiblity in bind mounts to containers, and to support persistent
overlays for writable containers.</li><li><strong>Unprivileged user namespaces</strong> - (minimum kernel &gt;=3.8, &gt;=3.18
recommended) Required to run containers without root or setuid
privilege.</li></ul><p>RHEL &amp; CentOS 6 do not support these features, but Singularity can be
used with some limitations.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="filesystem-support--limitations"></a>Filesystem support / limitations<a class="hash-link" href="#filesystem-support--limitations" title="Direct link to heading">#</a></h4><p>Singularity supports most filesystems, but there are some limitations
when installing Singularity on, or running containers from, common
parallel / network filesystems. In general:</p><ul><li>We strongly recommend installing Singularity on local disk on each
compute node.</li><li>If Singularity is installed to a network location, a
<code>--localstatedir</code> should be provided on each node, and Singularity
configured to use it.</li><li>The <code>--localstatedir</code> filesystem should support overlay mounts.</li><li><code>TMPDIR</code> / <code>SINGULARITY_TMPDIR</code> should be on a local filesystem
wherever possible.</li></ul><p>.. note::</p><p>   Set the <code>--localstatedir</code> location by by providing
<code>--localstatedir my/dir</code> as an option when you configure your
Singularity build with <code>./mconfig</code>.</p><p>   Disk usage at the <code>--localstatedir</code> location is neglible
(&lt;1MiB). The directory is used as a location to mount the container
root filesystem, overlays, bind mounts etc. that construct the
runtime view of a container. You will not see these mounts from a
host shell, as they are made in a separate mount namespace.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="overlay-support"></a>Overlay support<a class="hash-link" href="#overlay-support" title="Direct link to heading">#</a></h5><p>Various features of Singularity, such as the <code>--writable-tmpfs</code> and
<code>--overlay</code>, options use the Linux <code>overlay</code> filesystem driver to
construct a container root filesystem that combines files from
different locations. Not all filesystems can be used with the
<code>overlay</code> driver, so when containers are run from these filesystems
some Singularity features may not be available.</p><p>Overlay support has two aspects:</p><ul><li><code>lowerdir</code> support for a filesystem allows a directory on that
filesystem to act as the &#x27;base&#x27; of a container. A filesystem must
support overlay <code>lowerdir</code> for you be able to run a Singularity
sandbox container on it, while using functionality such as
<code>--writable-tmpfs</code> / <code>--overlay</code>.</li><li><code>upperdir</code> support for a filesystem allows a directory on that
filesystem to be merged on top of a <code>lowerdir</code> to construct a
container. If you use the <code>--overlay</code> option to overlay a
directory onto a container, then the filesystem holding the
overlay directory must support <code>upperdir</code>.</li></ul><p>Note that any overlay limitations mainly apply to sandbox (directory)
containers only. A SIF container is mounted into the
<code>--localstatedir</code> location, which should generally be on a local
filesystem that supports overlay.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="fakeroot--subuidgid-mapping"></a>Fakeroot / (sub)uid/gid mapping<a class="hash-link" href="#fakeroot--subuidgid-mapping" title="Direct link to heading">#</a></h5><p>When Singularity is run using the :ref:<code>fakeroot &lt;fakeroot&gt;</code> option it
creates a user namespace for the container, and UIDs / GIDs in that
user namepace are mapped to different host UID / GIDs.</p><p>Most local filesystems (ext4/xfs etc.) support this uid/gid mapping in
a user namespace.</p><p>Most network filesystems (NFS/Lustre/GPFS etc.) <em>do not</em> support this
uid/gid mapping in a user namespace. Because the fileserver is not
aware of the mappings it will deny many operations, with &#x27;permission
denied&#x27; errors. This is currently a generic problem for rootless
container runtimes.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="singularity-cache--atomic-rename"></a>Singularity cache / atomic rename<a class="hash-link" href="#singularity-cache--atomic-rename" title="Direct link to heading">#</a></h5><p>Singularity will cache SIF container images generated from remote
sources, and any OCI/docker layers used to create them. The cache is
created at <code>$HOME/.singularity/cache</code> by default. The location of
the cache can be changed by setting the <code>SINGULARITY_CACHEDIR</code>
environment variable.</p><p>The directory used for <code>SINGULARITY_CACHEDIR</code> should be:</p><ul><li>A unique location for each user. Permissions are set on the cache
so that private images cached for one user are not exposed to
another. This means that <code>SINGULARITY_CACHEDIR</code> cannot be shared.</li><li>Located on a filesystem with sufficient space for the number and size of
container images anticipated.</li><li>Located on a filesystem that supports atomic rename, if possible.</li></ul><p>In Singularity version 3.6 and above the cache is concurrency safe.
Parallel runs of Singularity that would create overlapping cache
entries will not conflict, as long as the filesystem used by
<code>SINGULARITY_CACHEDIR</code> supports atomic rename operations.</p><p>Support for atomic rename operations is expected on local POSIX
filesystems, but varies for network / parallel filesystems and may be
affected by topology and configuration. For example, Lustre supports
atomic rename of files only on a single MDT. Rename on NFS is only
atomic to a single client, not across systems accessing the same NFS
share.</p><p>If you are not certain that your <code>$HOME</code> or <code>SINGULARITY_CACHEDIR</code>
filesytems support atomic rename, do not run Singularity in parallel
using remote container URLs. Instead use <code>singularity pull</code> to
create a local SIF image, and then run this SIF image in a parallel
step. An alternative is to use the <code>--disable-cache</code> option, but
this will result in each Singularity instance independently fetching
the container from the remote source, into a temporary location.</p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="nfs"></a>NFS<a class="hash-link" href="#nfs" title="Direct link to heading">#</a></h5><p>NFS filesystems support overlay mounts as a <code>lowerdir</code> only, and do not
support user-namespace (sub)uid/gid mapping.</p><ul><li>Containers run from SIF files located on an NFS filesystem do not
have restrictions.</li><li>You cannot use <code>--overlay mynfsdir/</code> to overlay a directory onto
a container when the overlay (upperdir) directory is on an NFS
filesystem.</li><li>When using <code>--fakeroot</code> to build or run a container, your
<code>TMPDIR</code> / <code>SINGULARITY_TMPDIR</code> should not be set to an NFS
location.</li><li>You should not run a sandbox container with <code>--fakeroot</code> from an
NFS location.</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="lustre--gpfs"></a>Lustre / GPFS<a class="hash-link" href="#lustre--gpfs" title="Direct link to heading">#</a></h5><p>Lustre and GPFS do not have sufficient <code>upperdir</code> or <code>lowerdir</code>
overlay support for certain Singularity features, and do not support
user-namespace (sub)uid/gid mapping.</p><ul><li>You cannot use <code>-overlay</code> or <code>--writable-tmpfs</code> with a sandbox
container that is located on a Lustre or GPFS filesystem. SIF
containers on Lustre / GPFS will work correctly with these
options.</li><li>You cannot use <code>--overlay</code> to overlay a directory onto a
container, when the overlay (upperdir) directory is on a Lustre or
GPFS filesystem.</li><li>When using <code>--fakeroot</code> to build or run a container, your
<code>TMPDIR/SINGULARITY_TMPDIR</code> should not be a Lustre or GPFS
location.</li><li>You should not run a sandbox container with <code>--fakeroot</code> from a
Lustre or GPFS location.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="before-you-begin"></a>Before you begin<a class="hash-link" href="#before-you-begin" title="Direct link to heading">#</a></h3><p>If you have an earlier version of Singularity installed, you should
:ref:<code>remove it &lt;remove-an-old-version&gt;</code> before executing the
installation commands.  You will also need to install some
dependencies and install <a href="https://golang.org/" target="_blank" rel="noopener noreferrer">Go</a>.</p><p>.. _install-dependencies:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="install-from-source"></a>Install from Source<a class="hash-link" href="#install-from-source" title="Direct link to heading">#</a></h3><p>To use the latest version of Singularity from GitHub you will need to
build and install it from source. This may sound daunting, but the
process is straightforward, and detailed below:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="install-dependencies"></a>Install Dependencies<a class="hash-link" href="#install-dependencies" title="Direct link to heading">#</a></h4><p>On Red Hat Enterprise Linux or CentOS install the following dependencies:</p><p>.. code-block:: sh</p><p>   $ sudo yum update -y &amp;&amp; \
sudo yum groupinstall -y &#x27;Development Tools&#x27; &amp;&amp; \
sudo yum install -y \
openssl-devel \
libuuid-devel \
libseccomp-devel \
wget \
squashfs-tools \
cryptsetup</p><p>On Ubuntu or Debian install the following dependencies:</p><p>.. code-block:: sh</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo apt-get update &amp;&amp; sudo apt-get install -y \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    build-essential \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    uuid-dev \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    libgpgme-dev \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    squashfs-tools \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    libseccomp-dev \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    wget \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    pkg-config \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    git \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    cryptsetup-bin</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>.. note::</p><p>   You can build Singularity (3.5+) without <code>cryptsetup</code> available, but will
not be able to use encrypted containers without it installed on your system.</p><p>.. _install-go:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="install-go"></a>Install Go<a class="hash-link" href="#install-go" title="Direct link to heading">#</a></h4><p>Singularity v3 is written primarily in Go, and you will need Go 1.13
or above installed to compile it from source.</p><p>This is one of several ways to <a href="https://golang.org/doc/install" target="_blank" rel="noopener noreferrer">install and configure Go</a>.</p><p>.. note::</p><p>   If you have previously installed Go from a download, rather than an
operating system package, you should remove your <code>go</code> directory,
e.g. <code>rm -r /usr/local/go</code> before installing a newer
version. Extracting a new version of Go over an existing
installation can lead to errors when building Go programs, as it
may leave old files, which have been removed or replaced in newer
versions.</p><p>Visit the <a href="https://golang.org/dl/" target="_blank" rel="noopener noreferrer">Go download page</a> and pick a package
archive to download. Copy the link address and download with wget.  Then extract
the archive to <code>/usr/local</code> (or use other instructions on go installation
page).</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export VERSION=1.14.12 OS=linux ARCH=amd64 &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    wget https://dl.google.com/go/go$VERSION.$OS-$ARCH.tar.gz &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo tar -C /usr/local -xzvf go$VERSION.$OS-$ARCH.tar.gz &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm go$VERSION.$OS-$ARCH.tar.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Then, set up your environment for Go.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ echo &#x27;export GOPATH=${HOME}/go&#x27; &gt;&gt; ~/.bashrc &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    echo &#x27;export PATH=/usr/local/go/bin:${PATH}:${GOPATH}/bin&#x27; &gt;&gt; ~/.bashrc &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    source ~/.bashrc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="download-singularity-from-a-release"></a>Download Singularity from a release<a class="hash-link" href="#download-singularity-from-a-release" title="Direct link to heading">#</a></h4><p>You can download Singularity from one of the releases. To see a full
list, visit <a href="https://github.com/hpcng/singularity/releases" target="_blank" rel="noopener noreferrer">the GitHub release page</a>.  After deciding on
a release to install, you can run the following commands to proceed
with the installation.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export VERSION={InstallationVersion} &amp;&amp; # adjust this as necessary \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    wget https://github.com/hpcng/singularity/releases/download/v${VERSION}/singularity-${VERSION}.tar.gz &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    tar -xzf singularity-${VERSION}.tar.gz &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    cd singularity</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="checkout-code-from-git"></a>Checkout Code from Git<a class="hash-link" href="#checkout-code-from-git" title="Direct link to heading">#</a></h4><p>The following commands will install Singularity from the <a href="https://github.com/hpcng/singularity" target="_blank" rel="noopener noreferrer">GitHub repo</a> to <code>/usr/local</code>. This
method will work for &gt;=v{InstallationVersion}. To install an older
tagged release see <a href="https://www.sylabs.io/docs/" target="_blank" rel="noopener noreferrer">older versions of the docs</a>.</p><p>When installing from source, you can decide to install from either a
<strong>tag</strong>, a <strong>release branch</strong>, or from the <strong>master branch</strong>.</p><ul><li><p><strong>tag</strong>: GitHub tags form the basis for releases, so installing from
a tag is the same as downloading and installing a <a href="https://github.com/hpcng/singularity/releases" target="_blank" rel="noopener noreferrer">specific release</a>.  Tags are
expected to be relatively stable and well-tested.</p></li><li><p><strong>release branch</strong>: A release branch represents the latest version
of a minor release with all the newest bug fixes and enhancements
(even those that have not yet made it into a point release).  For
instance, to install v3.2 with the latest bug fixes and enhancements
checkout <code>release-3.2</code>.  Release branches may be less stable than
code in a tagged point release.</p></li><li><p><strong>master branch</strong>: The <code>master</code> branch contains the latest,
bleeding edge version of Singularity. This is the default branch
when you clone the source code, so you don&#x27;t have to check out any
new branches to install it. The <code>master</code> branch changes quickly
and may be unstable.</p></li></ul><p>To ensure that the Singularity source code is downloaded to the
appropriate directory use these commands.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ git clone https://github.com/hpcng/singularity.git &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    cd singularity &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    git checkout v{InstallationVersion}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="compile-singularity"></a>Compile Singularity<a class="hash-link" href="#compile-singularity" title="Direct link to heading">#</a></h4><p>Singularity uses a custom build system called <code>makeit</code>.  <code>mconfig</code>
is called to generate a <code>Makefile</code> and then <code>make</code> is used to
compile and install.</p><p>To support the SIF image format, automated networking setup etc., and
older Linux distributions without user namespace support, Singularity
must be <code>make install</code>ed as root or with <code>sudo</code>, so it can install
the <code>libexec/singularity/bin/starter-setuid</code> binary with root
ownership and setuid permissions for privileged operations. If you
need to install as a normal user, or do not want to use setuid
functionality :ref:<code>see below &lt;install-nonsetuid&gt;</code>.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ./mconfig &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    make -C ./builddir &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo make -C ./builddir install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>By default Singularity will be installed in the <code>/usr/local</code>
directory hierarchy. You can specify a custom directory with the
<code>--prefix</code> option, to <code>mconfig</code> like so:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ./mconfig --prefix=/opt/singularity</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>This option can be useful if you want to install multiple versions of
Singularity, install a personal version of Singularity on a shared
system, or if you want to remove Singularity easily after installing
it.</p><p>For a full list of <code>mconfig</code> options, run <code>mconfig --help</code>.  Here
are some of the most common options that you may need to use when
building Singularity from source.</p><ul><li><p><code>--sysconfdir</code>: Install read-only config files in sysconfdir.
This option is important if you need the <code>singularity.conf</code> file
or other configuration files in a custom location.</p></li><li><p><code>--localstatedir</code>: Set the state directory where containers are
mounted. This is a particularly important option for administrators
installing Singularity on a shared file system.  The
<code>--localstatedir</code> should be set to a directory that is present on
each individual node.</p></li><li><p><code>-b</code>: Build Singularity in a given directory. By default this is
<code>./builddir</code>.</p></li></ul><p>.. _install-nonsetuid:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="unprivileged-non-setuid-installation"></a>Unprivileged (non-setuid) Installation<a class="hash-link" href="#unprivileged-non-setuid-installation" title="Direct link to heading">#</a></h4><p>If you need to install Singularity as a non-root user, or do not wish
to allow the use of a setuid root binary, you can configure
singularity with the <code>--without-suid</code> option to mconfig:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ ./mconfig --without-suid --prefix=/home/dave/singularity &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    make -C ./builddir &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    make -C ./builddir install</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you have already installed Singularity you can disable the setuid
flow by setting the option <code>allow setuid = no</code> in
<code>etc/singularity/singularity.conf</code> within your installation
directory.</p><p>When singularity does not use setuid all container execution will use
a user namespace. This requires support from your operating system
kernel, and imposes some limitations on functionality. You should
review the <a href="/docs-admin/userns-requirements">requirements</a> and
<a href="/docs-admin/userns-limitations">limitations</a> in the <a href="/docs-admin/userns">user namespace</a> section of this guide.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="source-bash-completion-file"></a>Source bash completion file<a class="hash-link" href="#source-bash-completion-file" title="Direct link to heading">#</a></h4><p>To enjoy bash shell completion with Singularity commands and options,
source the bash completion file:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ . /usr/local/etc/bash_completion.d/singularity</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Add this command to your <code>~/.bashrc</code> file so that bash completion
continues to work in new shells.  (Adjust the path if you
installed Singularity to a different location.)</p><p>.. _install-rpm:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="build-and-install-an-rpm"></a>Build and install an RPM<a class="hash-link" href="#build-and-install-an-rpm" title="Direct link to heading">#</a></h3><p>If you use RHEL, CentOS or SUSE, building and installing a Singularity
RPM allows your Singularity installation be more easily managed,
upgraded and removed. In Singularity &gt;=v3.0.1 you can build an RPM
directly from the <a href="https://github.com/hpcng/singularity/releases" target="_blank" rel="noopener noreferrer">release tarball</a>.</p><p>.. note::</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Be sure to download the correct asset from the [GitHub releases page](https://github.com/hpcng/singularity/releases).  It</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">should be named `singularity-&lt;version&gt;.tar.gz`.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>After installing the :ref:<code>dependencies &lt;install-dependencies&gt;</code> and
installing :ref:<code>Go &lt;install-go&gt;</code> as detailed above, you are ready to
download the tarball and build and install the RPM.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export VERSION={InstallationVersion} &amp;&amp; # adjust this as necessary \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    wget https://github.com/hpcng/singularity/releases/download/v${VERSION}/singularity-${VERSION}.tar.gz &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rpmbuild -tb singularity-${VERSION}.tar.gz &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo rpm -ivh ~/rpmbuild/RPMS/x86_64/singularity-$VERSION-1.el7.x86_64.rpm &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm -rf ~/rpmbuild singularity-$VERSION*.tar.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you encounter a failed dependency error for golang but installed it
from source, build with this command:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rpmbuild -tb --nodeps singularity-${VERSION}.tar.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Options to <code>mconfig</code> can be passed using the familiar syntax to
<code>rpmbuild</code>.  For example, if you want to force the local state
directory to <code>/mnt</code> (instead of the default <code>/var</code>) you can do the
following:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">rpmbuild -tb --define=&#x27;_localstatedir /mnt&#x27; singularity-$VERSION.tar.gz</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>.. note::</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> It is very important to set the local state directory to a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> directory that physically exists on nodes within a cluster when</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> installing Singularity in an HPC environment with a shared file</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> system. </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="build-an-rpm-from-git-source"></a>Build an RPM from Git source<a class="hash-link" href="#build-an-rpm-from-git-source" title="Direct link to heading">#</a></h4><p>Alternatively, to build an RPM from a branch of the Git repository you
can clone the repository, directly <code>make</code> an rpm, and use it to install
Singularity:</p><p>.. code-block:: none</p><p>  $ ./mconfig &amp;&amp; \
make -C builddir rpm &amp;&amp; \
sudo rpm -ivh ~/rpmbuild/RPMS/x86_64/singularity-{InstallationVersion}.el7.x86_64.rpm # or whatever version you built</p><p>To build an rpm with an alternative install prefix set <code>RPMPREFIX</code>
on the make step, for example:</p><p>.. code-block:: none</p><p>  $ make -C builddir rpm RPMPREFIX=/usr/local</p><p>For finer control of the rpmbuild process you may wish to use <code>make
dist</code> to create a tarball that you can then build into an rpm with
<code>rpmbuild -tb</code> as above.</p><p>.. _remove-an-old-version:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="remove-an-old-version"></a>Remove an old version<a class="hash-link" href="#remove-an-old-version" title="Direct link to heading">#</a></h3><p>In a standard installation of Singularity 3.0.1 and beyond (when
building from source), the command <code>sudo make install</code> lists all the
files as they are installed. You must remove all of these files and
directories to completely remove Singularity.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo rm -rf \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/local/libexec/singularity \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/local/var/singularity \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/local/etc/singularity \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/local/bin/singularity \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/local/bin/run-singularity \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    /usr/local/etc/bash_completion.d/singularity</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you anticipate needing to remove Singularity, it might be easier to
install it in a custom directory using the <code>--prefix</code> option to
<code>mconfig</code>.  In that case Singularity can be uninstalled simply by
deleting the parent directory. Or it may be useful to install
Singularity :ref:<code>using a package manager &lt;install-rpm&gt;</code> so that it
can be updated and/or uninstalled with ease in the future.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="distribution-packages-of-singularity"></a>Distribution packages of Singularity<a class="hash-link" href="#distribution-packages-of-singularity" title="Direct link to heading">#</a></h3><p>.. note::</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Packaged versions of Singularity in Linux distribution repos are</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">maintained by community members. They may be older releases of</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Singularity, as it can take time to package and distribute new</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">versions. For the latest upstream versions of Singularity it is</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">recommended that you build from source using one of the methods</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">detailed above.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="install-the-centosrhel-package-using-yum"></a>Install the CentOS/RHEL package using yum<a class="hash-link" href="#install-the-centosrhel-package-using-yum" title="Direct link to heading">#</a></h4><p>The EPEL (Extra Packages for Enterprise Linux) repos contain
Singularity rpms that are regularly updated. To install Singularity
from the epel repos, first install the epel-release package and then
install Singularity.  For instance, on CentOS 6/7/8 do the following:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ sudo yum update -y &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo yum install -y epel-release &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo yum update -y &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    sudo yum install -y singularity</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="testing--checking-the-build-configuration"></a>Testing &amp; Checking the Build Configuration<a class="hash-link" href="#testing--checking-the-build-configuration" title="Direct link to heading">#</a></h3><p>After installation you can perform a basic test of Singularity
functionality by executing a simple container from the Sylabs Cloud
library:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ singularity exec library://alpine cat /etc/alpine-release</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3.9.2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>See the <code>user guide
&lt;https://www.sylabs.io/guides/\{userversion\}/user-guide/&gt;</code>__ for more
information about how to use Singularity.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="singularity-buildcfg"></a>singularity buildcfg<a class="hash-link" href="#singularity-buildcfg" title="Direct link to heading">#</a></h4><p>Running <code>singularity buildcfg</code> will show the build configuration of
an installed version of Singularity, and lists the paths used by
Singularity. Use <code>singularity buildcfg</code> to confirm paths are set
correctly for your installation, and troubleshoot any &#x27;not-found&#x27;
errors at runtime.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ singularity buildcfg</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PACKAGE_NAME=singularity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PACKAGE_VERSION={InstallationVersion}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BUILDDIR=/home/dtrudg/Sylabs/Git/singularity/builddir</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">PREFIX=/usr/local</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">EXECPREFIX=/usr/local</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BINDIR=/usr/local/bin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SBINDIR=/usr/local/sbin</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LIBEXECDIR=/usr/local/libexec</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DATAROOTDIR=/usr/local/share</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DATADIR=/usr/local/share</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SYSCONFDIR=/usr/local/etc</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SHAREDSTATEDIR=/usr/local/com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LOCALSTATEDIR=/usr/local/var</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RUNSTATEDIR=/usr/local/var/run</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INCLUDEDIR=/usr/local/include</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">DOCDIR=/usr/local/share/doc/singularity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">INFODIR=/usr/local/share/info</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LIBDIR=/usr/local/lib</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">LOCALEDIR=/usr/local/share/locale</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MANDIR=/usr/local/share/man</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SINGULARITY_CONFDIR=/usr/local/etc/singularity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">SESSIONDIR=/usr/local/var/singularity/mnt/session</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Note that the <code>LOCALSTATEDIR</code> and <code>SESSIONDIR</code> should be on local,
non-shared storage.</p><p>The list of files installed by a successful <code>setuid</code> installation of
Singularity can be found in the :ref:<code>appendix, installed files
section &lt;installed-files&gt;</code>.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="test-suite"></a>Test Suite<a class="hash-link" href="#test-suite" title="Direct link to heading">#</a></h4><p>The Singularity codebase includes a test suite that is run during
development using CI services.</p><p>If you would like to run the test suite locally you can run the test
targets from the <code>builddir</code> directory in the source tree:</p><ul><li><code>make check</code> runs source code linting and dependency checks</li><li><code>make unit-test</code> runs basic unit tests</li><li><code>make integration-test</code> runs integration tests</li><li><code>make e2e-test</code> runs end-to-end tests, which exercise a large
number of operations by calling the singularity CLI with different
execution profiles.</li></ul><p>.. note::</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Running the full test suite requires a `docker` installation,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">and `nc` in order to test docker and instance/networking</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">functionality.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Singularity must be installed in order to run the full</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">test suite, as it must run the CLI with setuid privilege for the </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">`starter-suid` binary.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>.. warning::</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">`sudo` privilege is required to run the full tests, and you</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">should not run the tests on a production system. We recommend</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">running the tests in an isolated development or build</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">environment.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="installation-on-windows-or-mac"></a>Installation on Windows or Mac<a class="hash-link" href="#installation-on-windows-or-mac" title="Direct link to heading">#</a></h2><p>Linux container runtimes like Singularity cannot run natively on
Windows or Mac because of basic incompatibilities with the host
kernel. (Contrary to a popular misconception, MacOS does not run on a
Linux kernel. It runs on a kernel called Darwin originally forked
from BSD.)</p><p>For this reason, the Singularity community maintains a set of Vagrant
Boxes via <code>Vagrant Cloud &lt;https://www.vagrantup.com/&gt;</code>_<em>, one of
<code>Hashicorp&#x27;s &lt;https://www.hashicorp.com/#open-source-tools&gt;</code></em> open
source tools. The current versions can be found under the <code>sylabs
&lt;https://app.vagrantup.com/sylabs&gt;</code>_ organization.</p><p>Sylabs has also developed a beta version of Singularity Desktop for
Mac, which runs Singularity in a lightweight virtual machine, in a
transparent manner.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="windows"></a>Windows<a class="hash-link" href="#windows" title="Direct link to heading">#</a></h3><p>Install the following programs:</p><ul><li><code>Git for Windows &lt;https://git-for-windows.github.io/&gt;</code>_</li><li><code>VirtualBox for Windows &lt;https://www.virtualbox.org/wiki/Downloads&gt;</code>_</li><li><code>Vagrant for Windows &lt;https://www.vagrantup.com/downloads.html&gt;</code>_</li><li><code>Vagrant Manager for Windows &lt;http://vagrantmanager.com/downloads/&gt;</code>_</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mac"></a>Mac<a class="hash-link" href="#mac" title="Direct link to heading">#</a></h3><p>To use Singularity Desktop for macOS (Beta Preview):</p><p>Download a Mac installer package <code>here
&lt;https://www.sylabs.io/singularity-desktop-macos/&gt;</code>__.</p><p>Singularity is also available via Vagrant (installable with
<code>Homebrew &lt;https://brew.sh&gt;</code>_ or manually) or with the Singularity Desktop for
macOS (Alpha Preview).</p><p>To use Vagrant via Homebrew:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ /usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ brew install --cask virtualbox &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    brew install --cask vagrant &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    brew install --cask vagrant-manager</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="singularity-vagrant-box"></a>Singularity Vagrant Box<a class="hash-link" href="#singularity-vagrant-box" title="Direct link to heading">#</a></h3><p>Run Git Bash (Windows) or open a terminal (Mac) and create and enter a
directory to be used with your Vagrant VM.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ mkdir vm-singularity &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    cd vm-singularity</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>If you have already created and used this folder for another VM, you will need
to destroy the VM and delete the Vagrantfile.</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ vagrant destroy &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    rm Vagrantfile</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Then issue the following commands to bring up the Virtual Machine. (Substitute a
different value for the <code>$VM</code> variable if you like.)</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ export VM=sylabs/singularity-3.5-ubuntu-bionic64 &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    vagrant init $VM &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    vagrant up &amp;&amp; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    vagrant ssh</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>You can check the installed version of Singularity with the following:</p><p>.. code-block:: none</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">vagrant@vagrant:~$ singularity version</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">{InstallationVersion}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><p>Of course, you can also start with a plain OS Vagrant box as a base and then
install Singularity using one of the above methods for Linux.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/hpcng/singularity-web/edit/main/docs-admin/installation.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-admin/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Admin Quick Start</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs-admin/configfiles"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration Files Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installation-on-linux" class="table-of-contents__link">Installation on Linux</a><ul><li><a href="#system-requirements" class="table-of-contents__link">System Requirements</a></li><li><a href="#before-you-begin" class="table-of-contents__link">Before you begin</a></li><li><a href="#install-from-source" class="table-of-contents__link">Install from Source</a></li><li><a href="#build-and-install-an-rpm" class="table-of-contents__link">Build and install an RPM</a></li><li><a href="#remove-an-old-version" class="table-of-contents__link">Remove an old version</a></li><li><a href="#distribution-packages-of-singularity" class="table-of-contents__link">Distribution packages of Singularity</a></li><li><a href="#testing--checking-the-build-configuration" class="table-of-contents__link">Testing &amp; Checking the Build Configuration</a></li></ul></li><li><a href="#installation-on-windows-or-mac" class="table-of-contents__link">Installation on Windows or Mac</a><ul><li><a href="#windows" class="table-of-contents__link">Windows</a></li><li><a href="#mac" class="table-of-contents__link">Mac</a></li><li><a href="#singularity-vagrant-box" class="table-of-contents__link">Singularity Vagrant Box</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs-user">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://join.slack.com/t/hpcng/shared_invite/zt-ll5c3ofb-XhvMPbXUhTVrHlutQz2jbA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://groups.google.com/a/lbl.gov/g/singularity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/news">News</a></li><li class="footer__item"><a href="https://github.com/hpcng/singularity" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 HPCng. - All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8b668661.js"></script>
<script src="/assets/js/main.d90a00b9.js"></script>
</body>
</html>
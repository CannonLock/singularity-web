<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="Singularity Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="Singularity Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Singularity" href="/opensearch.xml"><title data-react-helmet="true">Security in Singularity | Singularity</title><meta data-react-helmet="true" property="og:url" content="https://singularity.hpcng.org/docs-user/about/security"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Security in Singularity | Singularity"><meta data-react-helmet="true" name="description" content="Containers are popular for many good reasons. They are light weight,"><meta data-react-helmet="true" property="og:description" content="Containers are popular for many good reasons. They are light weight,"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://singularity.hpcng.org/docs-user/about/security"><link data-react-helmet="true" rel="alternate" href="https://singularity.hpcng.org/docs-user/about/security" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://singularity.hpcng.org/docs-user/about/security" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.df3ffb68.css">
<link rel="preload" href="/assets/js/runtime~main.8647c1f1.js" as="script">
<link rel="preload" href="/assets/js/main.68317f8c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Singularity</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs-user/">User Documentation</a><a class="navbar__item navbar__link" href="/docs-admin/">Administrator Documentation</a><a class="navbar__item navbar__link" href="/news">News</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hpcng/singularity" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.png" alt="Singularity Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">Singularity</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs-user/">User Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/docs-admin/">Administrator Documentation</a></li><li class="menu__list-item"><a class="menu__link" href="/news">News</a></li><li class="menu__list-item"><a href="https://github.com/hpcng/singularity" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">About</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs-user/">Introduction to Singularity</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs-user/about/security">Security in Singularity</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Security in Singularity</h1></header><div class="markdown"><p>Containers are popular for many good reasons. They are light weight,
easy to spin-up and require reduced IT management resources as
compared to hardware VM environments. More importantly, container
technology facilitates advanced research computing by granting the
ability to package software in highly portable and reproducible
environments encapsulating all dependencies, including the operating
system. But there are still some challenges to container security.</p><p>Singularity addresses some core missions of containers : Mobility of
Compute, Reproducibility, HPC support, and <strong>Security</strong>. This section
gives an overview of security features supported by Singularity,
especially where they differ from other container runtimes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="security-policy"></a>Security Policy<a class="hash-link" href="#security-policy" title="Direct link to heading">#</a></h2><p>Security is not a check box that one can tick and forget.  Ensuring
security is a ongoing process that begins with software architecture,
and continues all the way through to ongoing security practices.  In
addition to ensuring that containers are run without elevated
privileges where appropriate, and that containers are produced by
trusted sources, users must monitor their containers for newly
discovered vulnerabilities and update when necessary just as they
would with any other software. Sylabs is constantly probing to find
and patch vulnerabilities within Singularity, and will continue to do
so.</p><p>If you suspect you have found a vulnerability in Singularity, please
follow the steps in our published <code>Security Policy
&lt;https://sylabs.io/security-policy&gt;</code>__.</p><p>so that it can be disclosed, investigated, and fixed in an appropriate
manner.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="singularity-pro---long-term-support--security-patches"></a>Singularity PRO - Long Term Support &amp; Security Patches<a class="hash-link" href="#singularity-pro---long-term-support--security-patches" title="Direct link to heading">#</a></h2><p>Security patches for Singularity are applied to the latest open-source
version, so it is important to follow new releases and upgrade when
neccessary.</p><p>SingularityPRO is a professionally curated and licensed version of
Singularity that provides added security, stability, and support
beyond that offered by the open source project. Security and bug-fix
patches are backported to select versions of Singularity PRO, so that
they can be deployed long-term where required. PRO users receive
security fixes (without specific notification or detail) prior to
public disclosure, as detailed in the <code>Sylabs Security Policy
&lt;https://sylabs.io/security-policy&gt;</code>__.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="singularity-runtime--user-privilege"></a>Singularity Runtime &amp; User Privilege<a class="hash-link" href="#singularity-runtime--user-privilege" title="Direct link to heading">#</a></h2><p>The Singularity Runtime enforces a unique security model that makes it
appropriate for <em>untrusted users</em> to run <em>untrusted containers</em> safely
on multi-tenant resources. When you run a container, the processes in
the container will run as your user account. Singularity dynamically
writes UID and GID information to the appropriate files within the
container, and the user remains the same <em>inside</em> and <em>outside</em>
the container, i.e., if you&#x27;re an unprivileged user while entering the
container you&#x27;ll remain an unprivileged user inside the container.</p><p>Additional blocks are in place to prevent users from escalating
privileges once they are inside of a container. The container file
system is mounted using the <code>nosuid</code> option, and processes are
started with the <code>PR_NO_NEW_PRIVS</code> flag set. This means that even if
you run <code>sudo</code> inside your container, you won&#x27;t be able to change to
another user, or gain root priveleges by other means. This approach
provides a secure way for users to run containers and greatly
simplifies things like reading and writing data to the host system
with appropriate ownership.</p><p>It is also important to note that the philosophy of Singularity is
<em>Integration</em> over <em>Isolation</em>. Most container run times strive to
isolate your container from the host system and other containers as
much as possible. Singularity, on the other hand, assumes that the
userâ€™s primary goals are portability, reproducibility, and ease of use
and that isolation is often a tertiary concern. Therefore, Singularity
only isolates the mount namespace by default, and will bind mount
several host directories such as <code>$HOME</code> and <code>/tmp</code> into the
container at runtime. If needed, additional levels of isolation can be
achieved by passing options causing Singularity to enter any or all of
the other kernel namespaces and to prevent automatic bind mounting.
These measures allow users to interact with the host system from
within the container in sensible ways.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="singularity-image-format-sif"></a>Singularity Image Format (SIF)<a class="hash-link" href="#singularity-image-format-sif" title="Direct link to heading">#</a></h2><p>Ensuring container security as a continuous process. Singularity
provides ways to ensure integrity throughout the lifecyle of a
container, i.e. at rest, in transit and while running. The SIF
Singularity Image Format has been designed to achieve these goals.</p><p>A SIF file is an immutable container image that packages the container
environment into a single file. SIF supports security and integrity
through the ability to cryptographically sign a container, creating a
signature block within the SIF file which can guarantee immutability
and provide accountability as to who signed it. Singularity follows
the <code>OpenPGP &lt;https://www.openpgp.org/&gt;</code>_ standard to create and
manage these signatures, and the keys used to create them. After
building an image with Singularity, a user can <code>singularity sign</code>
the container and push it to the Library along with its public PGP key
(stored in :ref:<code>Keystore &lt;keystore&gt;</code>). The signature can be verified
(<code>singularity verify</code>) while pulling or downloading the
image. :ref:<code>This feature &lt;signNverify&gt;</code> makes it easy to to establish
trust in collaborations within and between teams.</p><p>In Singularity 3.4 and above, the root file system of a container
(stored in the squashFS partition of SIF) can be encrypted. As a
result, everything inside the container becomes inaccessible without
the correct key or passphrase. Other users on the system will be able
to look inside your container files. The content of the container is
private, even if the SIF file is shared in public.</p><p>Unlike other container platforms where execution requires a number of
layers to be extracted to a rootfs directory on the host, Singularity
executes containers in a single step, directly from the immutable
<code>.sif</code>. This reduces the attack surface and allows the container to
be easily verified at runtime, to ensure it has not been tampered with.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="admin-configurable-files"></a>Admin Configurable Files<a class="hash-link" href="#admin-configurable-files" title="Direct link to heading">#</a></h2><p>System administrators who manage Singularity can use configuration
files, to set security restrictions, grant or revoke a userâ€™s
capabilities, manage resources and authorize containers etc.</p><p>For example, the <code>ecl.toml
&lt;https://sylabs.io/guides/\{adminversion\}/admin-guide/configfiles.html#ecl-toml&gt;</code>_
file allows blacklisting and whitelisting of containers.</p><p>Configuration files and their parameters are documented for administrators
documented <code>here
&lt;https://sylabs.io/guides/\{adminversion\}/admin-guide/configfiles.html&gt;</code>__.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="cgroups-support"></a>cgroups support<a class="hash-link" href="#cgroups-support" title="Direct link to heading">#</a></h3><p>Starting with v3.0, Singularity added native support for <code>cgroups</code>,
allowing users to limit the resources their containers consume without
the help of a separate program like a batch scheduling system. This
feature can help to prevent DoS attacks where one container seizes
control of all available system resources in order to stop other
containers from operating properly.  To use this feature, a user first
creates a cgroups configuration file. An example configuration file is
installed by default with Singularity as a guide. At runtime, the
<code>--apply-cgroups</code> option is used to specify the location of the
configuration file to apply to the container and cgroups are
configured accordingly. More about cgroups support <code>here
&lt;https://sylabs.io/guides/\{adminversion\}/admin-guide/configfiles.html#cgroups-toml&gt;</code>__.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="--security-options"></a><code>--security</code> options<a class="hash-link" href="#--security-options" title="Direct link to heading">#</a></h3><p>Singularity supports a number of methods for further modifying the
security scope and context when running Singularity containers.  Flags
can be passed to the action commands; <code>shell</code>, <code>exec</code>, and <code>run</code>
allowing fine grained control of security. Details about them are
documented :ref:<code>here &lt;security-options&gt;</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="security-in-the-sylabs-cloud"></a>Security in the Sylabs Cloud<a class="hash-link" href="#security-in-the-sylabs-cloud" title="Direct link to heading">#</a></h2><p><code>Sylabs Cloud &lt;https://cloud.sylabs.io/home&gt;</code>_ consists of a Remote
Builder, a Container Library, and a Keystore. Together, theses
services provide an end-to-end solution for packaging and distributing
applications in secure and trusted containers.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="remote-builder"></a>Remote Builder<a class="hash-link" href="#remote-builder" title="Direct link to heading">#</a></h3><p>As mentioned earlier, the Singularity runtime prevents executing code
with root-level permissions on the host system. However, building a
container requires elevated privileges that most shared environments
do not grant their users. The <code>Build Service
&lt;https://cloud.sylabs.io/builder&gt;</code>_ aims to address this by allowing
unprivileged users to build containers remotely, with root level
permissions inside the secured service. System administrators can use
the system to monitor which users are building containers, and the
contents of those containers. The Singularity CLI has native
integration with the Build Service from version 3.0 onwards. In
addition, a browser interface to the Build Service also exists, which
allows users to build containers using only a web browser.</p><p>.. note::</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><div tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Please also see the :ref:`Fakeroot feature &lt;fakeroot&gt;` which is a</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">secure option for admins in multi-tenant HPC environments and</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">similar use cases where they might want to grant a user special</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">privileges inside a container.</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Fakeroot has some limitations, and requires unpriveleged user</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">namespace support in the host kernel.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="container-library"></a>Container Library<a class="hash-link" href="#container-library" title="Direct link to heading">#</a></h3><p>The <code>Container Library &lt;https://cloud.sylabs.io/library&gt;</code>_ allows
users to store and share Singularity container images in the
Singularity Image Format (SIF). A web front-end allows users to create
new projects within the Container Library, edit documentation
associated with container images, and discover container images
published by their peers.</p><p>.. _keystore:</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="key-store"></a>Key Store<a class="hash-link" href="#key-store" title="Direct link to heading">#</a></h3><p>The <code>Key Store &lt;https://cloud.sylabs.io/keystore&gt;</code><em> is a key
management system offered by Sylabs that uses an <code>OpenPGP
implementation &lt;https://gnupg.org/&gt;</code></em> to permit sharing and discovery
of PGP public keys used to sign and verify Singularity container
images. This service is based on the OpenPGP HTTP Keyserver Protocol
(HKP), with several enhancements:</p><ul><li>The Service requires connections to be secured with Transport Layer
Security (TLS).</li><li>The Service implements token-based authentication, allowing only
authenticated users to add or modify PGP keys.</li><li>A web front-end allows users to view and search for PGP keys using a
web browser.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="authentication-and-encryption"></a>Authentication and encryption<a class="hash-link" href="#authentication-and-encryption" title="Direct link to heading">#</a></h3><ol><li><p>Communication between users, the authentication service other
services is secured via TLS encryption.</p></li><li><p>The services support authentication of users via signed and encrypted authentication
tokens.</p></li><li><p>There is no implicit trust relationship between each service. Each
request between the services is authenticated using the
authentication token supplied by the user in the associated
request.</p></li></ol></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/hpcng/singularity-web/edit/main/docs-user/about/security.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs-user/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Introduction to Singularity</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#security-policy" class="table-of-contents__link">Security Policy</a></li><li><a href="#singularity-pro---long-term-support--security-patches" class="table-of-contents__link">Singularity PRO - Long Term Support &amp; Security Patches</a></li><li><a href="#singularity-runtime--user-privilege" class="table-of-contents__link">Singularity Runtime &amp; User Privilege</a></li><li><a href="#singularity-image-format-sif" class="table-of-contents__link">Singularity Image Format (SIF)</a></li><li><a href="#admin-configurable-files" class="table-of-contents__link">Admin Configurable Files</a><ul><li><a href="#cgroups-support" class="table-of-contents__link">cgroups support</a></li><li><a href="#--security-options" class="table-of-contents__link"><code>--security</code> options</a></li></ul></li><li><a href="#security-in-the-sylabs-cloud" class="table-of-contents__link">Security in the Sylabs Cloud</a><ul><li><a href="#remote-builder" class="table-of-contents__link">Remote Builder</a></li><li><a href="#container-library" class="table-of-contents__link">Container Library</a></li><li><a href="#key-store" class="table-of-contents__link">Key Store</a></li><li><a href="#authentication-and-encryption" class="table-of-contents__link">Authentication and encryption</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs-user">Getting Started</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://join.slack.com/t/hpcng/shared_invite/zt-ll5c3ofb-XhvMPbXUhTVrHlutQz2jbA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li><li class="footer__item"><a href="https://groups.google.com/a/lbl.gov/g/singularity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mailing List</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/news">News</a></li><li class="footer__item"><a href="https://github.com/hpcng/singularity" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 HPCng. - All Rights Reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8647c1f1.js"></script>
<script src="/assets/js/main.68317f8c.js"></script>
</body>
</html>